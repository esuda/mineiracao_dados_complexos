install.packages("factoextra")
install.packages("NbClust")
install.packages("fpc")
install.packages("gridExtra")
install.packages("dbscan")
install.packages("ppclust")
install.packages("fclust")
install.packages("apcluster")
knitr::opts_chunk$set(echo = TRUE, error = FALSE, message = FALSE, warning = FALSE, tidy = FALSE)
options(digits = 3)
# Adicione os pacotes usados neste trabalho:
library(dplyr)
library(ggplot2)
library(factoextra)
library(NbClust)
library(fpc)
library(gridExtra)
library(dbscan)
library(ppclust)
library(fcllust)
# Adicione os pacotes usados neste trabalho:
library(dplyr)
library(ggplot2)
library(factoextra)
library(NbClust)
library(fpc)
library(gridExtra)
library(dbscan)
library(ppclust)
library(fclust)
library(apcluster)
# Configure ambiente de trabalho na mesma pasta
# onde colocou a base de dados:
# setwd("")
setwd("C:\\Users\\Eric\\Documents\\GitHub\\mineiracao_dados_complexos\\Aprendizado de Maquina Nao Supervisionado\\Trabalho 3")
# Leitura da base
read.table('imports-85.data',sep=',')
# Tratamento de dados faltantes
# Leitura da base
df <- read.table('imports-85.data',sep=',')
# Tratamento de dados faltantes
summary(df)
table(df)
# Tratamento de dados faltantes
summary(df)
colnames(df)
head(df)
unique(df$v2)
df$v2
unique(df$V2)
head(df)
unique(df$V2)
as.integer(df$v2)
unique(as.integer(df$v2))
?grep
as.numeric(df$v2)
gsub(pattern='?', replacement='', df$V2)
```{r atv1a-code}
gsub(pattern='?', replacement='', df$V2)
gsub(pattern='[?]', replacement='', df$V2)
gsub(pattern='[?]', replacement=NA, df$V2)
as.numeric(gsub(pattern='[?]', replacement=NA, df$V2))
df$V2 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V2))
unique(df$V19)
df$V19 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V19))
unique(df$V20)
unique(df$V22)
unique(df$V26)
# Tratando "?" que apresenta nas bases para poder transformar em numerico
df$V2 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V2))
df$V19 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V19))
df$V20 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V20))
df$V22 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V22))
df$V23 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V23))
df$V26 <- as.numeric(gsub(pattern='[?]', replacement=NA, df$V26))
summary(df)
df[df$V2==NA,]
summary(df)
df[is.na(df$V2),]
df[df$V3=='alfa-romero',]
df[is.na(df$V19),]
df[df$V3=='mazda',]
df[df$V3=='mazda' ,c(V3, V19, V20)] %>% group_by(V3) %>% summarise(media_v19=mean(V19), media_V20=mean(V20))
df[df$V3=='mazda' ,c('V3', 'V19', 'V20')] %>% group_by(V3) %>% summarise(media_v19=mean(V19), media_V20=mean(V20))
lines =
df[df$V3=='mazda' & !is.na(df$V19) ,c('V3', 'V19', 'V20')] %>% group_by(V3) %>% summarise(media_v19=mean(V19), media_V20=mean(V20))
df[df$V3=='mazda' & !is.na(df$V19) ,c('V3', 'V19', 'V20')] %>% group_by(V3) %>% summarise(media_v19=mean(V19), media_V20=mean(V20))
linhas = df$V3=='mazda' & !is.na(df$V19)
colunas = c('V3', 'V19', 'V20')
media_mazda = df[linhas,colunas] %>% group_by(V3) %>% summarise(media_v19=mean(V19), media_V20=mean(V20))
linhas2 = df$V3=='mazda' & is.na(df$V19)
df[linhas2,'V19'] = media_mazda$media_v19
# Substituindo V19 e V20 que estao NA pela media
df[df$V3=='mazda' & is.na(df$V19),'V19'] = media_mazda$media_v19
df[df$V3=='mazda' & is.na(df$V20),'V20'] = media_mazda$media_V20
summary(df)
df[is.na(df$V22),]
df[df$V3=='renault',]
ggplot(df, aes(x=V22, y= ..density..)) +
geom_histogram(color='White', bins=100) +
geom_density()
ggplot(df, aes(x=V23, y= ..density..)) +
geom_histogram(color='White', bins=100) +
geom_density()
ggplot(df, aes(x=V23, y= ..density..)) +
geom_histogram(color='White', bins=10) +
geom_density()
ggplot(df, aes(x=V22, y= ..density..)) +
geom_histogram(color='White', bins=10) +
geom_density()
ggplot(df, aes(x=V23, y= ..density..)) +
geom_histogram(color='White', bins=10) +
geom_density()
linhas = df$V3=='renault' & !is.na(df$V22)
colunas = c('V3', 'V22', 'V23')
media_renault = df[linhas,colunas] %>% group_by(V3) %>% summarise(media_v22=mean(V22), media_V23=mean(V23))
df[df$V3=='renault' & is.na(df$V22),'V22'] = media_mazda$media_v22
df[df$V3=='renault' & is.na(df$V22),'V22'] = media_renault$media_v22
media_renault
# Como temos apenas 2 carros da marca renault, vamos observar a distribuicao de V22 e V23
df[is.na(df$V22),]
df[linhas,colunas] %>% group_by(V3) %>% summarise(media_v22=mean(V22), media_V23=mean(V23))
linhas <- !is.na(df$V22)
colunas <- c('V3', 'V22', 'V23')
media_renault <- df[linhas,colunas] %>% group_by(V3) %>% summarise(media_v22=median(V22), media_V23=median(V23))
colunas <- c('V22', 'V23')
media_renault <- df[linhas,colunas] %>% summarise(media_v22=median(V22), media_V23=median(V23))
media_renault <- df[linhas,colunas] %>% summarise(mediana_v22=median(V22), mediana_V23=median(V23))
df[df$V3=='renault' & is.na(df$V22),'V22'] = media_renault$mediana_v22
df[df$V3=='renault' & is.na(df$V23),'V23'] = media_renault$mediana_V23
summary(df)
#--------
df[is.na(df$V26),]
df[is.na(df$V26),]
df[df$V3=='renault',
]
df[is.na(df$V26),]
#--------
df[!is.na(df$V26),]
#--------
df[is.na(df$V26),]
df[df$V3=='audi',]
#--------
df[is.na(df$V26),]
# Marcas para verificar 'audi', 'isuzu', 'porsche'
df[df$V3=='audi',]
# Marcas para verificar 'audi', 'isuzu', 'porsche'
df[df$V3=='isuzu',]
# Marcas para verificar 'audi', 'isuzu', 'porsche'
df[df$V3=='porsche',]
# Marcas para verificar 'audi', 'isuzu', 'porsche'
df[df$V3 %in% c('audi', 'isuzu', 'porsche'),]
df[linhas, colunas] %>% group_by(V3) %>% summarise(mean_26=mean(V26))
linhas = df$V3 %in% c('audi', 'isuzu', 'porsche') & !is.na(df$V26)
colunas = c('V3', 'V26')
df[linhas, colunas] %>% group_by(V3) %>% summarise(mean_26=mean(V26))
df[df$V3=='audi' & is.na(df$V26),'V26'] <- media_marcas[media_marcas$V3=='audi']
media_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(mean_26=mean(V26))
df[df$V3=='audi' & is.na(df$V26),'V26'] <- media_marcas[media_marcas$V3=='audi']
View(media_marcas)
media_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(media_26=mean(V26))
df[df$V3=='audi' & is.na(df$V26),'V26'] <- media_marcas[media_marcas$V3=='audi','media_26']
df[df$V3=='isuzu' & is.na(df$V26),'V26'] <- media_marcas[media_marcas$V3=='isuzu','media_26']
df[df$V3=='porsche' & is.na(df$V26),'V26'] <- media_marcas[media_marcas$V3=='porsche','media_26']
summary(df)
#--------
# Verificando coluna V2
df[is.na(df$V2),]
#--------
# Verificando coluna V2
unique(df[is.na(df$V2),'V3'])
#--------
# Verificando coluna V2
df[df$V3 %in% unique(df[is.na(df$V2),'V3'])]
#--------
# Verificando coluna V2
df[df$V3 %in% unique(df[is.na(df$V2),'V3']),]
#--------
# Verificando coluna V2
teste <- df[df$V3 %in% unique(df[is.na(df$V2),'V3']),]
teste
ggplot(df, aes(x=V2, y= ..density..)) +
geom_histogram(color='White', bins=10) +
geom_density()
linhas <- df$V3 %in% unique(df[is.na(df$V2),'V3']) & !is.na(df$V26)
colunas <- c('V3', 'V2')
media_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(media_2=mean(V2))
media_marcas
linhas <- df$V3 %in% unique(df[is.na(df$V2),'V3']) & !is.na(df$V2)
colunas <- c('V3', 'V2')
media_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(media_2=mean(V2))
media_marcas
for (marca in unique(media_marcas$V3) ){
df[df$V3==marca & is.na(df$V2),'V2'] <- media_marcas[media_marcas$V3==marca,'media_2']
}
summary(df)
teste <- df[df$V3 %in% unique(df[is.na(df$V2),'V3']),]
teste
# Para as marcas em que todos os carros apresentam V2 nulo, tiramos a mediana da base
linhas <- is.na(df$V2)
colunas <- c('V3', 'V2')
mediana_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(mediana_2=median(V2))
mediana_marcas
# Para as marcas em que todos os carros apresentam V2 nulo, tiramos a mediana da base
linhas <- !is.na(df$V2)
colunas <- c('V3', 'V2')
mediana_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(mediana_2=median(V2))
mediana_marcas
colunas <- c('V2')
mediana_marcas <- df[linhas, colunas] %>% group_by(V3) %>% summarise(mediana_2=median(V2))
mediana_marcas
mediana_marcas <- df[linhas, colunas] %>% summarise(mediana_2=median(V2))
df[linhas, colunas]
linhas <- !is.na(df$V22)
colunas <- c('V22', 'V23')
media_renault <- df[linhas,colunas] %>% summarise(mediana_v22=median(V22), mediana_V23=median(V23))
View(media_renault)
colunas <- 'V2'
mediana_marcas <- df[linhas, colunas] %>% summarise(mediana_2=median(V2))
mediana_marcas <- average(df[linhas, colunas])
mediana_marcas <- median(df[linhas, colunas])
mediana_marcas
df[linhas, colunas]
# Para as marcas em que todos os carros apresentam V2 nulo, tiramos a mediana da base
linhas <- !is.na(df$V2)
colunas <- 'V2'
mediana_marcas <- median(df[linhas, colunas])
mediana_marcas
mediana_marcas <- median(df[linhas, colunas])
mediana_marcas
for (marca in unique(df[is.na$V2, 'V3'])) {
df[df$V3==marca & is.na(df$V2),'V2'] <- mediana_marcas
}
for (marca in unique(df[is.na(df$V2), 'V3'])) {
df[df$V3==marca & is.na(df$V2),'V2'] <- mediana_marcas
}
summary(df)
summary(df)
