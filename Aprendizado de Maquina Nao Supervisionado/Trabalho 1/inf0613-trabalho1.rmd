---
title: INF0613 -- Aprendizado de Máquina Não Supervisionado
output: pdf_document
subtitle: Trabalho 1 - Regras de Associação
author: 
  - Daniel Noriaki Kurosawa
  - Eric Uyemura Suda
  - Fernando Shigeru Wakabayashi
---


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, error = FALSE, message = FALSE, warning = FALSE, tidy = FALSE)
options(digits = 3)
```

Neste primeiro trabalho vamos minerar Regras de Associação em uma base de dados que contém as vendas de uma padaria. A base de dados está disponível na página da disciplina no Moodle (arquivo `bakery.csv`).

# Atividade 0 -- Configurando o ambiente
Antes de começar a implementação do seu trabalho configure o _workspace_ e importe todos os pacotes:

```{r atv0-code}
# Adicione os demais pacotes usados
# Bibliotecas usadas neste trabalho:
library(arules)

# Configurando ambiente de trabalho:

```


# Atividade 1 -- Análise Exploratória da Base de Dados (*3,0 pts*)

Dado um caminho para uma base de dados, leia as transações e faça uma análise Exploratória sobre elas. Use as funções `summary`,  `inspect` e `itemFrequencyPlot`. Na função `inspect` limite sua análise às 10 primeiras transações e na função `itemFrequencyPlot` gere um gráfico com a frequência relativa dos 30 itens mais frequentes. 

```{r atv1-code}
# Ler transações
transactions <- read.transactions("bakery.csv", format="basket", sep=",")

# Visualizando transações
inspect(transactions[1:10])

# Sumário da base
summary(transactions)

# Analisando a frequência dos itens 
itemFrequencyPlot(transactions,topN = 30)

```


## Análise 

a) Descreva a base de dados discutindo os resultados das funções acima. 

**Resposta:** <!-- Escreva sua resposta abaixo -->
Para este conjunto de dados há 2.579 transações sendo que existem 91 objetos únicos de compra registrados. Em média há 3,2 ítens sendo comprados por transação e uma distribuição da seguinte forma, primeiro quartil igual a 2 ítens, mediana igual a 3, terceiro quartil igual a 4 e máxmo de ítens igual a 10. Os ítens mais comprados individualmente fazem sentido já que as transações são de uma bakery, logo há no top 5 café, pão, chá, bolo e doces.

<!-- Fim da resposta -->

b) Ao gerarmos o gráfico de frequências, temos uma representação visual de uma informação já presente no resultado da função `summary`. Contudo, esse gráfico nos dá uma visão mais ampla da base. Assim podemos ver a frequência de outros itens em relação aos 10 mais frequentes. Quais informações podemos obter a partir desse gráfico (e da análise anterior) para nos ajudar na extração de regras de associação com o algoritmo `apriori`? Isto é, como a frequência dos itens pode afetar os parâmetros de configuração do algoritmo `apriori`? 

**Resposta:** <!-- Escreva sua resposta abaixo -->
A frequencia dos ítens afeta o algoritmo pois quanto mais ítens distintos, mais combinações podem ser realizadas na hora de se gerar as regras, deve-se atentar aos parâmetros de suporte e confiança mínimos para se adequarem aos dados. 

<!-- Fim da resposta -->

# Atividade 2 -- Minerando Regras (*3,5 pts*)

Use o algoritmo `apriori` para minerar regras na base de dados fornecida. Experimente com pelo menos *3 conjuntos* de valores diferentes de suporte e confiança para encontrar regras de associação. Imprima as cinco regras com o maior suporte de cada conjunto escolhido.  Lembre-se de usar seu conhecimento sobre a base, obtido na questão anterior, para a escolha dos valores de suporte e confiança.

```{r atv2-code}
# Conjunto 1: suporte =    e confiança =    
regras <- apriori(data=transactions, 
                  parameter=list(supp=0.5, conf=0.15,minlen=2), 
                  appearance=list(default="rhs", lhs="Coffee"),
                  control=list(verbose=F))
regras <- sort(regras, decreasing=TRUE, by="confidence")
inspect(regras[1:5])


# Conjunto 2: suporte =    e confiança =    
 regras <- apriori(data=transactions, 
                  parameter=list(supp=0.001, conf=0.15,minlen=2), 
                  appearance=list(default="rhs", lhs="Bread"),
                  control=list(verbose=F))
regras <- sort(regras, decreasing=TRUE, by="confidence")
inspect(regras[1:5])


# Conjunto 3: suporte =    e confiança =    
regras <- apriori(data=transactions, 
                  parameter=list(supp=0.001, conf=0.15,minlen=2), 
                  appearance=list(default="rhs", lhs="Pastry"),
                  control=list(verbose=F))
regras <- sort(regras, decreasing=TRUE, by="confidence")
inspect(regras[1:5])


```

## Análises 
a) Quais as regras mais interessantes geradas a partir dessa base? Justifique.

**Resposta:** <!-- Escreva sua resposta abaixo -->


<!-- Fim da resposta -->

# Atividade 3 -- Medidas de Interesse (*3,5 pts*)

Vimos na aula que, mesmo após as podas do algoritmo `apriori`, ainda temos algumas regras com características indesejáveis como redundâncias e dependência estatística negativa. Também vimos algumas medidas que nos ajudam a analisar melhor essas regras como o lift, a convicção e a razão de chances. Nesta questão, escolha um dos conjuntos de regras geradas na atividade anterior e o analise usando essas medidas. Compute as três medidas para o conjunto escolhido com a função `interestMeasure` e experimente ordenar as regras com cada uma das novas medidas.


```{r atv3-code}
# Compute as medidas de interesse 
medidas <- interestMeasure(regras, 
                           c("confidence", "conviction",
                             "coverage", "support", 
                             "oddsRatio", "leverage"), Groceries)


# Apresente as regras ordenadas por lift
inspect(head(sort(regras, by="lift"), 5))

# Apresente as regras ordenadas por convicção
inspect(sort(sort(regras, by="conviction"), by="confidence")[1:5])
# Apresente as regras ordenadas por razão de chances


```


## Análise 
a) Quais as regras mais interessantes do conjunto? Justifique.

**Resposta:** <!-- Escreva sua resposta abaixo -->


<!-- Fim da resposta -->

